http://www.pentest-standard.org/index.php/Vulnerability_Analysis


内容
1 测试
2 活跃
3 被动
4 验证
5 研究
测试
漏洞测试是发现可由攻击者利用的系统和应用程序中的漏洞的过程。这些缺陷可能包括主机和服务配置错误，或者不安全的应用程序设计。虽然用于查找缺陷的过程各不相同，并且高度依赖于所测试的特定组件，但一些关键原则适用于该过程。
在进行任何类型的漏洞分析时，测试人员应适当地确定适用深度和广度的测试范围，以满足所需结果的目标和/或要求。深度值可以包括评估工具的位置，认证要求等。例如; 在某些情况下，可能验证缓解的测试目标是否到位并且正常工作并且无法访问漏洞; 而在其他情况下，目标可能是使用经过身份验证的访问来测试每个适用的变量，以发现所有适用的漏洞。无论您的范围如何，都应根据实现目标的深度要求量身定制测试。应始终验证测试深度，以确保评估结果符合预期（即所有机器都进行了身份验证等）。除了深度，在进行漏洞测试时还必须考虑广度。广度值可以包括诸如目标网络，段，主机，应用程序，库存等等。在最简单的元素中，您的测试可能是查找主机系统上的所有漏洞; 而在其他情况下，您可能需要在给定的库存或边界中查找主机上的所有漏洞。此外，应始终验证测试范围，以确保您已达到测试范围（即扫描时库存中的每台机器是否存活？如果不是，为什么）。您的测试可能是找到主机系统上的所有漏洞; 而在其他情况下，您可能需要在给定的库存或边界中查找主机上的所有漏洞。此外，应始终验证测试范围，以确保您已达到测试范围（即扫描时库存中的每台机器是否存活？如果不是，为什么）。您的测试可能是找到主机系统上的所有漏洞; 而在其他情况下，您可能需要在给定的库存或边界中查找主机上的所有漏洞。此外，应始终验证测试范围，以确保您已达到测试范围（即扫描时库存中的每台机器是否存活？如果不是，为什么）。
活性
主动测试涉及与正在测试的组件直接交互以确定安全漏洞。这可以是低级组件，例如网络设备上的TCP堆栈，或者它可以是堆栈上的组件，例如用于管理这种设备的基于web的接口。与目标组件交互有两种不同的方式：自动化和手动。
自动化
自动化测试利用软件与目标进行交互，检查响应，并根据这些响应确定是否存在漏洞。自动化流程有助于减少时间和劳动力需求。例如，虽然连接到系统上的单个TCP端口以确定它是否打开以接收传入数据很简单，但对于每个可用的65,535个可能端口执行此步骤一次需要大量时间（如果手动完成）。当必须在多个网络地址上重复这样的测试时，所需的时间可能太大而不能在没有某种形式的自动化的情况下完成测试。使用软件执行这些功能允许测试人员完成手头的任务，并将注意力集中在处理数据和执行更适合手动测试的任务上。
网络/常规漏洞扫描程序
基于端口
基于端口的自动扫描通常是传统渗透测试的第一步，因为它有助于获得目标网络或主机上可用内容的基本概述。基于端口的扫描程序检查以确定远程主机上的端口是否能够接收连接。通常，这将涉及利用IP的协议（例如TCP，UDP，ICMP等）。但是，其他网络协议上的端口也可能存在，并且依赖于环境（例如，它在大型主机环境中很常见）供SNA使用）。通常，端口可以具有以下两种可能状态之一：
    打开 - 端口能够接收数据
    已关闭 - 端口无法接收数据
如果扫描仪无法准确确定给定端口是打开还是关闭，则可以列出其他状态，例如“已过滤”。
当扫描程序确定端口已打开时，扫描程序会假定是否存在漏洞。例如，如果基于端口的扫描程序连接到TCP端口23，并且该端口正在侦听，则扫描程序可能会报告远程主机上的telnet服务可用，并将其标记为启用了明文验证协议。
服务基础
基于服务的漏洞扫描程序是利用特定协议与远程主机上的开放端口进行通信的扫描程序，以确定有关该端口上运行的服务的更多信息。这比端口扫描更精确，因为它不依赖端口来确定正在运行的服务。例如，端口扫描可能能够识别TCP端口8000在主机上是打开的，但它不会仅基于该信息知道在那里运行什么服务。服务扫描器将尝试使用不同的协议与端口通信。如果端口8000上运行的服务能够使用HTTP正确通信，则它将被标识为Web服务器。
横幅掠夺
横幅抓取是连接到特定端口并检查从远程主机返回的数据以识别绑定到该端口的服务/应用程序的过程。通常在连接过程中，软件将提供识别字符串，其可以包括诸如应用程序的名称之类的信息，或者关于软件的特定版本正在运行的信息。

Web应用程序扫描程序
一般应用缺陷扫描仪
大多数Web应用程序扫描都以网站，Web应用程序或Web服务的地址开头。然后，扫描程序通过以下链接和目录结构来爬网站点。在编译所提供的网页，资源，服务和/或其他媒体的列表之后，扫描程序将执行测试或针对爬行的结果进行审计。例如，如果在爬网中发现的网页具有表单字段，则扫描程序可能会尝试SQL注入或跨站点脚本。如果已爬网页面包含错误，则扫描程序可能会查找错误详细信息中显示的敏感信息，依此类推。
应该注意的是，爬行和测试阶段可以交错并同时执行以减少总扫描时间。这是许多Web应用程序扫描程序的默认行为。
目录列表/暴力强制
假设网站上有可通过以下链接找不到爬虫的目录。在没有用户提供的这些目录的先验知识的情况下，扫描仪具有至少两个附加选项。
扫描程序/爬虫可以搜索“常用”目录。这些是具有常见名称和名称变体的目录，并且包含在由多年经验和扫描结果编译的列表中。大多数Web应用程序都有这种“内置”列表，而一些渗透测试人员则维护自己的自定义列表。有时目录名称足够独特，可用于识别具有相当高准确度的第三方Web应用程序。准确的目录列表通常是查找网站“管理”部分的关键 - 大多数渗透测试人员应该对发现非常感兴趣。
暴力强制目录是一种类似的方法，但不使用静态列表，而是使用工具来枚举目录名称可能具有的每种可能性。使用这种方法的缺点是它有可能使请求崩溃或淹没Web服务器，从而导致拒绝服务的情况。当有人密切关注Web服务器的状况时，尤其是在生产环境中，应该注意执行目录暴力破解。
您作为渗透测试人员想要执行目录列表的原因是扩展您的攻击字段或查找可能包含敏感信息的目录（这取决于渗透测试的目标，可能导致其中的主要发现）。
Web服务器版本/漏洞识别
许多Web应用程序扫描程序将尝试将Web服务器的版本与安全建议中的已知易受攻击版本进行比较。这种方法有时会导致误报; 因为在某些情况下，分叉或复制开源Web服务器并给出新名称，横幅和指定的不同版本号。应采取其他步骤来验证Web服务器实际上正在运行横幅或Web扫描程序报告的内容。
方法
一些Web服务器方法被认为是不安全的，并且可以允许攻击者获得对Web服务器内容的不同级别的访问。事实上，这些方法是Web服务器软件的一部分，而不是网站内容将其与目前讨论的其他漏洞区分开来。一些不安全的方法包括：
OPTIONS
虽然HTTP OPTIONS方法本身并不安全，但它可以允许攻击者轻松枚举目标服务器接受的各种HTTP方法。注意，OPTIONS方法并不总是准确的，下面的每个方法都应该单独验证。
PUT / DELETE
使用PUT方法，攻击者可以上传恶意内容，例如可用于在Web服务器上传输信息，更改Web内容或安装恶意软件的HTML页面。使用DELETE方法，攻击者可以删除内容或破坏导致服务中断的站点。
此外，现代REST应用程序以不同的方式使用PUT：
创建 - > POST读取 - > GET更新 - > PUT删除 - >删除
WebDAV的
WebDAV是Microsoft Internet Information Server（IIS）的一个组件。WebDAV代表“基于Web的分布式创作和版本控制”，用于编辑和文件管理。管理员使用WebDAV扩展在IIS Web服务器上远程管理和编辑Web内容，并且可以包括PROPFIND，COPY，MOVE，PROPPATCH，MKCOL，LOCK和UNLOCK .WebDAV与核心操作系统组件交互，这可以将系统暴露给几个可能的漏洞。其中一些潜在风险包括：
    由于不正确处理用户请求而导致的缓冲区溢出情况
    来自格式错误的请求的拒绝服务条件
    基于域的脚本攻击
    特权升级
    执行任意代码
TRACE / TRACK
现代Web服务器支持TRACE HTTP方法，该方法包含可能导致未经授权的信息泄露的缺陷。TRACE方法用于调试Web服务器连接，并允许客户端查看请求链另一端收到的内容。默认情况下，在所有主要Web服务器中启用，远程攻击者可能滥用HTTP TRACE功能来泄露敏感信息，从而导致机密性丢失。

网络漏洞扫描程序/特定协议
VPN
传统的漏洞评估工具无法与服务Internet密钥交换（IKE）的VPN设备进行正确的协议协商。在使用IKE的情况下，有必要使用其他工具包，这些工具包可以执行准确的指纹识别，退避模式和识别正在使用的身份验证机制等功能。通过识别VPN设备的这些属性，可以在运行代码版本以及诸如静态预共享密钥之类的身份验证类型中识别弱点。
语音网络扫描仪
战争拨号
许多组织仍然通过电话线使用带外接入。使用旨在进行战争拨号的漏洞评估工具可以确定身份验证和网络架构中的弱点。
网络电话
现在，大多数组织都拥有IP语音技术。已经开发了许多工具来进行VoIP基础设施的漏洞分析。使用这些工具，可以识别VoIP网络是否被正确分段，并且可能存在利用这些网络访问核心基础设施系统或在目标网络上记录电话对话的潜力。
手动直接连接
与任何自动化流程或技术一样，始终存在错误余量。系统，网络设备和网络连接中的不稳定性可能会在测试期间引入不准确的结果。始终建议对目标系统上可用的每个协议或服务执行手动直接连接，以验证自动测试的结果以及识别所有潜在的攻击媒介和以前未识别的弱点。
混淆
多个出口节点
安全监控和防御系统以识别来自特定IP地址的恶意活动为借口运行。在部署入侵检测系统和监控活动的情况下，来自多个IP地址的采购评估和攻击活动可提供更准确的结果，并减少目标网络上的监控设备识别和响应的机会。诸如TOR代理之类的技术可以提供一种方法来进行评估活动，而无需从单个IP地址获取。
IDS逃避
在针对部署IDS技术的目标环境开展评估活动时，可能需要执行规避。使用字符串操作，多态，会话拼接和碎片等方法可以绕过IDS设备中实现的签名匹配模式，从而提供更准确的结果。

被动
元数据分析
元数据分析涉及查看描述文件的数据，而不是文件数据本身。例如，Microsoft Office文档可能会列出文档作者，公司，上次保存文档的时间，创建文档的时间等等。许多文档甚至允许输入自定义元数据。这可能包含内部地址和服务器路径，内部IP地址以及渗透测试人员可用于获取其他访问或信息的其他信息。
虽然元数据在位于公司内部网络上的文档中非常常见，但公司应该在将文档提供给公众或公共Internet之前清除元数据。因此，攻击者可以被动获取的任何元数据（不直接攻击目标）都应被视为安全问题。
交通监控
流量监控是连接到内部网络和捕获数据以进行离线分析的概念。路线中毒被排除在此阶段之外，因为这些会在网络上产生“噪音”并且很容易被检测到。通常可以从“交换”网络中收集到多少敏感数据，这一点令人惊讶。这种“数据泄漏”到交换网络可以分类如下：
ARP / MAC缓存溢出，导致交换数据包被广播 - 这在具有不正确的ARP / MAC缓存时序配置的Cisco交换机上很常见。
Etherleak - 一些较旧的网络驱动程序和一些嵌入式驱动程序将使用系统内存中的数据来填充ARP数据包。如果可以收集足够的ARP数据包，则可以捕获来自内部存储器的敏感信息
配置错误的群集或负载平衡器
集线器插入网络请注意，其中一些类别只会导致数据泄漏到单个子网，而其他类别可能会导致泄漏到更大的网段。

验证
工具之间的相关性
使用多种工具时，对结果相关性的需求可能会变得复杂。相关性可以分为两种不同的样式，即项目的特定和分类相关性，两者都基于您尝试在给定目标上收集的信息类型，度量和统计信息而有用。
特定关联涉及特定的可定义问题，例如漏洞ID，CVE，OSVDB，供应商索引号，软件产品的已知问题等，并且可以与诸如主机名，IP，FQDN，MAC地址等微因素分组。这方面的例子是将主机x的结果按CVE编号分组，因为它们会在多个工具中索引相同的问题。
分类关联涉及合规框架（即NIST SP 800-53，DoD 5300系列，PCI，HIPPA，OWASP列表等）中的问题的分类结构，允许您按宏观因素（如漏洞类型）对项目进行分组，配置问题等。这样做的一个例子是将具有默认密码的主机的所有发现分组到NIST 800-53（IA-5）中的密码复杂性组中。
在大多数情况下，渗透测试人员将专注于在同一主机上的多个工具之间的冗余中发现的特定漏洞的微观问题。这种冗余会使测试输出中的统计结果发生偏差，从而导致错误的风险增加。
与此相反的是宏观相关性的过度减少或简化（即前10/20列表），因为结果会使输出偏斜，从而导致错误的风险降低。

手动测试/协议特定
VPN
指纹
指纹识别对于确定VPN设备的类型和正确安装的代码版本非常有用。通过准确地对设备进行指纹识别，然后可以针对目标系统进行适当的研究和分析。
认证
VPN设备可以使用各种形式的身份验证。使用不属于传统漏洞评估工具的VPN工具包，可以正确识别身份验证机制，并确定可能存在的弱点，例如预共享密钥或默认组ID。
思杰
列举
许多默认安装和配置不当的Citrix设备提供了枚举已发布应用程序并确定配置为对设备进行身份验证的有效用户名的方法。在暴力攻击和尝试打破授权用户的预定义配置文件时，此信息变得至关重要。
DNS
域名系统可以在攻击者未正确加固时为其提供大量信息。版本信息允许正确识别和准确的研究分析。区域转移等弱点提供了详尽的攻击目标列表以及与目标组织相关的潜在敏感数据的信息泄漏。
卷筒纸
Web服务为攻击者提供了一个大的环境。与大多数其他协议和服务不同，Web服务通常可以在单个系统的多个端口上运行。管理员可以将其强化重点放在Web服务或已发布目录的公共端口上，而忽略了正确强化其他属性。应始终以手动方式审查Web服务，因为自动评估工具无法识别其服务中的大多数弱点。
邮件
邮件服务器可以提供有关目标组织的大量信息。使用目标设备中的固有功能，可以进行有效帐户的确认，以及为其他系统上的其他攻击开发潜在用户名列表。诸如邮件中继之类的漏洞可以用于对组织的其他攻击，例如网络钓鱼。通常，邮件服务器将提供用于远程访问的Web界面，该界面可以用于暴力活动。

攻击大道
创建攻击树
在安全评估期间，随着测试在整个参与过程中的进展，开发攻击树的最终报告的准确性至关重要。随着新系统，服务和潜在漏洞的确定; 应该开发并定期更新攻击树。这在参与的开发阶段尤其重要，因为实现的一个入口点可以在攻击树的开发过程中映射出的其他向量上重复。
隔离实验室测试
在隔离的实验室中设置复制环境时，漏洞分析和利用的准确性要大得多。通常，系统可以通过特定的控制集或额外的保护机制来加强。通过设计模拟目标组织的实验室，顾问可以确保针对所需目标发现的漏洞和漏洞利用是可靠的，并减少不准确结果或系统不可操作性的机会。
视觉确认
手动连接与审查
虽然适当的相关性可以帮助减少错误的发现并提高整体准确性，但是目视系统的视觉检查是无可替代的。评估工具旨在检查协议/服务连接或响应的结果，并与已知的漏洞签名进行比较。但是，在识别可能内置到应用程序中的非常见端口或自定义逻辑上的服务时，工具并不总是准确的。通过手动评估目标系统，其可用服务以及为这些服务提供功能的应用程序，测试人员可以确保已完成正确的验证和漏洞识别。
研究
公共研究
一旦在目标系统中报告了漏洞，就必须确定问题识别的准确性，并在渗透测试范围内研究漏洞的潜在可利用性。在许多情况下，该漏洞将是商业或开源软件包中报告的软件漏洞，在其他情况下，漏洞可能是业务流程中的缺陷，或者是错误配置或默认密码使用等常见管理错误。
漏洞数据库
漏洞数据库可用于验证自动化工具报告的问题，或手动查看目标应用程序的漏洞。大多数工具将使用给定漏洞的CVE标识符，该漏洞可用于访问摘要信息以及指向CVE数据库中其他源的链接。CVE还可用于搜索漏洞数据库（如OSVDB和Bugtraq）或漏洞利用数据库和框架中的问题。
应使用漏洞数据库来验证报告问题的准确性。例如，Apache Web服务器漏洞可能存在于Windows上，但不存在于Linux上，而自动扫描程序可能不会将其考虑在内。
供应商咨询
供应商发布的安全建议和更改日志可以提供指向任何自动化工具可能无法报告的漏洞信息的指针。许多主要软件供应商报告了有关内部发现问题的有限详细信息以及独立研究人员协调漏洞披露的问题。如果研究人员选择对漏洞的详细信息保持沉默，则供应商建议通常是唯一可用的数据。在这些情况下，其他研究人员可能会独立发现更多细节，并将细节添加到漏洞数据库中。搜索供应商建议中使用的CVE可能会发现有关潜在可利用问题的更多详细信息。
更改日志可以为其他研究提供指导，尤其是在开源产品中，其中版本之间的差异可以揭示已修复但未广为人知的漏洞，并且可能不会因升级或安装而优先考虑。
利用数据库和框架模块
许多漏洞利用数据库在Internet上得到了积极维护和公开访问。安全研究人员和漏洞利用编写者并不总是将他们的漏洞利用代码提交给多个站点，因此建议熟悉多个站点，并检查每个站点是否有利用漏洞代码来对抗潜在的漏洞应用程序。虽然某些漏洞数据库跟踪漏洞利用率，但其覆盖范围通常不完整，不应视为详尽无遗。
商业和开源漏洞利用框架也可用于研究漏洞。在大多数情况下，可用的漏洞利用模块列在其公共网站上，可以作为问题可利用性的有价值的指示。
通用/默认密码
通常，管理员和技术人员选择弱密码，从不更改默认密码或根本不设置任何密码。大多数软件和硬件的手册都可以在线轻松找到，并提供默认凭证。Internet论坛和官方供应商邮件列表可以提供有关未记录的帐户，常用密码和经常配置错误的帐户的信息。最后，许多网站记录默认/后门密码，应检查每个已识别的系统。
强化指南/常见错误配置
渗透测试的主要目标之一是模拟实际攻击者的策略和行为。虽然自动扫描可以缩短测试的时间窗口，但没有扫描仪可以像人类一样工作。强化指南可以作为渗透测试仪的宝贵参考。它们不仅突出了系统中最薄弱的部分，而且通过验证已实施的推荐数量，您可以了解管理员的勤奋程度。在每次渗透测试期间，应该花时间检查每个主要系统及其建议的强化设置，以便发现管理员留下的漏洞。
用户论坛和邮件列表可以提供有关系统的重要信息以及管理员在配置和保护它们时遇到的各种问题。测试人员应该研究目标系统，就像他自己安装一个系统一样，并发现痛点和可能的配置错误所在的位置。
私人研究
设置副本环境
虚拟化技术允许安全研究人员运行各种操作系统和应用程序，而无需专用硬件。当识别出目标操作系统或应用程序时，可以快速创建虚拟机（VM）环境以模拟目标。测试人员可以使用此VM来探索应用程序的配置参数和行为，而无需直接连接到目标。
测试配置
测试VM实验室应包含所有常见操作系统的基本映像，包括Windows XP，Vista，7，Server 2003和Server 2008，Debian，Ubuntu，Red Hat和Mac OS X。为每个Service Pack级别维护单独的映像将简化重新创建目标环境的过程。完整的VM库与支持克隆的VM环境相结合，可以让测试人员在几分钟内启动新的目标VM。此外，使用快照功能可以更有效地工作并重现错误。
起毛
模糊测试或故障注入是一种通过以编程方式向应用程序提交有效，随机或意外输入来查找应用程序缺陷的强力技术。基本过程包括将调试器附加到目标应用程序，然后针对特定输入区域运行模糊测试例程，然后分析任何崩溃后的程序状态。虽然有些测试人员针对特定目标编写了自己的模糊器，但仍有许多模糊测试应用程序可用。
确定潜在的途径/载体
登录或连接到目标网络应用程序以识别命令和其他输入区域。如果目标是读取文件和/或网页的桌面应用程序，请分析接受的文件格式以获取数据输入的途径。一些简单的测试涉及提交无效字符或非常长的字符串以导致崩溃。附加调试器以在发生成功崩溃时分析程序状态。
反汇编和代码分析
一些编程语言允许反编译，一些特定的应用程序使用符号进行编译以进行调试。测试人员可以利用这些功能来分析程序流程并识别潜在的漏洞。应分析开源应用程序的源代码是否存在缺陷。用PHP编写的Web应用程序共享许多相同的漏洞，其源代码应作为任何测试的一部分进行检查。
