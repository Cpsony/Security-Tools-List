http://www.pentest-standard.org/index.php/Threat_Modeling

内容
1 总则
1.1 高级威胁建模过程
1.2 例子
1.3 高级建模工具
2 商业资产分析
2.1 组织数据
2.1.1 政策，计划和程序
2.1.2 产品信息（如商业秘密，研发数据）
2.1.3 营销信息（计划，路线图等）
2.1.4 财务信息（如银行，信贷，股权账户）
2.1.5 技术信息
2.1.6 员工数据
2.1.7 客户数据
2.2 人力资产
3 业务流程分析
3.1 技术基础设施支持流程
3.2 信息资产支持流程
3.3 人力资产支持流程
3.4 第三方集成和/或过程使用
4 威胁代理/社区分析
4.1 员工
4.2 管理（执行，中间）
5 威胁能力分析
5.1 使用中的工具分析
5.2 相关漏洞/有效载荷的可用性
5.3 沟通机制
5.4 可访问性
6 动机建模
7 查找受损组织的相关新闻
一般
本节定义了正确执行渗透测试所需的威胁建模方法。该标准不使用特定模型，而是要求所使用的模型在威胁的表示，其能力，根据被测试组织的资格，以及重复应用于未来测试的能力方面保持一致。相同的结果。

该标准侧重于传统威胁建模的两个关键要素 - 资产和攻击者（威胁社区/代理）。每一个都分别分为业务资产和业务流程以及威胁社区及其功能。

至少应在每次渗透测试中清楚地识别和记录所有四个要素。

在对攻击者进行建模时，除了威胁社区（主要是语义并且可以与组织的业务SWOT分析相关联）和功能（主要是技术）之外，还应该提供动机建模的其他方面。这些附加点基本上考虑了目标可用的不同资产的价值，并与获得它的成本相结合。作为补充模型，还应该为组织执行影响建模，以便更准确地查看围绕每个已识别资产的丢失事件的“假设？”场景。这应考虑资产“净值”，其内在价值以及与损失事件相关的其他间接产生的成本。

任何渗透测试参与的威胁建模阶段对于测试人员和组织都至关重要。它提供了清晰的组织风险偏好和优先级（哪些资产比其他资产更重要？哪些威胁社区比其他人更具相关性？）。此外，它使测试人员能够专注于提供密切模拟攻击者的工具，技术，功能，可访问性和一般配置文件的参与，同时牢记组织内部的实际目标是什么，以便更相关的控制，流程和基础设施进行测试，而不是IT元素的库存清单。威胁模型应尽可能与正在测试的组织协调构建，

该模型应清晰记录，并作为最终报告的一部分提供，因为报告中的结果将引用威胁模型，以便创建特定于组织的更准确的相关性和风险评分（而不是通用技术）一）。

高级威胁建模过程
收集相关文档
识别主要和次要资产并对其进行分类
识别威胁和威胁社区并对其进行分类
将威胁社区映射到主要和次要资产
例
根据PTES评估，内部托管的CRM应用程序可能在范围内。存储在后端数据库中的客户信息是一个易于识别的主要资产，因为它直接链接到范围内的应用程序。但是，通过查看数据库服务器的技术设计，还可以识别出存储在同一后端数据库服务器上的HR数据库是次要资产。攻击者可以使用CRM应用程序作为获取员工信息的垫脚石。在基本威胁建模练习中，某些威胁社区在映射到CRM应用程序时可能被识别为不相关，但通过识别威胁格局突然改变的辅助资产。

高级建模工具
有多种工具可用于识别目标和映射攻击向量。这些通常关注业务资产（要定位的系统）和业务流程（如何攻击它们。）根据参与度，渗透测试团队可以在没有客户输入的情况下执行这些练习; 或者他们可能会花费大量时间与客户利益相关者确定感兴趣的目标。具有业务资产焦点的工具通常需要定量输入来描述每个潜在目标的重要性。输入也可以是定性的，例如客户的CIO描述系统是关键任务的。专注于业务流程的工具，

商业资产分析
在威胁建模练习的业务资产分析过程中，将对包含在范围内的所有资产及其支持的业务流程进行以资产为中心的视图。通过分析收集的文档并访问组织内的相关人员，测试人员能够识别最有可能成为攻击者目标的资产，他们的价值是什么以及他们（部分）损失的影响是什么。

组织数据
政策，计划和程序
内部政策，计划和程序定义了组织如何开展业务。这些文档特别令人感兴趣，因为它们可以帮助确定组织内的关键角色以及使公司运行的关键业务流程。

产品信息（例如商业秘密，研发数据）
产品相关信息包括任何专利，商业机密，未来计划，源代码，直接影响产品市场价值的支持系统，算法以及组织认为是此类产品业务成功的关键因素的任何其他信息。

营销信息（计划，路线图等）
促销，发布，产品变更，定位，合作伙伴关系，第三方提供商，与组织内外活动相关的业务计划的营销计划。此外，公关相关数据，如合作伙伴，记者，咨询公司的详细信息，以及与此类实体的任何通信，也被认为是一个备受追捧的目标。

财务信息（例如银行，信贷，股权账户）
财务信息通常是组织拥有的一些最受保护的信息。该信息可以包括银行账户信息，信用卡账户信息和/或信用卡号，以及投资账户等。

技术信息
有关组织和组织运营的技术信息是渗透测试人员特别感兴趣的。这些信息通常不是渗透测试的预期可交付成果，但是，它通过向其他领域提供有价值的信息来促进测试过程; 基础设施设计信息可以为情报收集过程提供有价值的数据。

基础设施设计信息
基础设施设计相关信息涉及用于运行组织的所有核心技术和设施。构建蓝图，技术布线和连接图，计算设备/网络设计和应用级数据处理都被视为基础设施设计信息。

系统配置信息
系统配置信息包括配置基线文档，配置清单和加固过程，组策略信息，操作系统映像，软件清单等。此信息可以帮助发现漏洞（例如通过配置错误或过时软件安装的知识）。

用户帐户凭据
用户帐户凭证有助于在非特权级别访问信息系统，只要存在认证方式（例如VPN，门户网站等）。

特权用户帐户凭据
只要存在认证手段（例如VPN，门户网站等），特权用户帐户凭证就有助于以更高的访问级别访问信息系统。获取特权用户帐户凭证通常会导致正在测试的信息系统受到损害。

员工数据
这里正在分析员工数据，因为任何可能对组织产生直接影响的数据都会被攻击者获取或泄露。必须遵守某些合规性的组织对这种数据的丢失或暴露进行罚款，这是直接损失影响的明显候选者。此外，员工可能被视为重要资产的组织也可能受到这样的审查（特定的政府机构，专门的商业秘密相关的员工/部门等......）。以下列表提供了可能被视为威胁建模的业务资产的个人数据的信息领域的示例。

国家识别号码（SSN等）
个人身份信息（PII）
受保护的健康信息（PHI）
财务信息（例如银行，信用账户）
客户数据
与员工数据非常相似，当此类信息会对组织造成直接/间接损失时，客户数据被视为威胁建模过程中的业务资产。除了监管/合规需求（基于罚款）之外，当此类数据可用于进行欺诈时，还有一个额外的因素起作用，即组织可能因与欺诈相关的损失而承担责任或起诉（基于失败）使欺诈行为发生的客户信息。以下列表提供了可能包含相关客户数据的此类信息领域的示例，并且应该将其视为企业资产以进行威胁建模

国家识别号码（SSN等）
个人身份信息（PII）
受保护的健康信息（PHI）
财务账户（例如银行，信贷，股权账户）
供应商数据
与被认为对组织至关重要的供应商相关的信息（例如关键组件制造商，可能属于商业秘密的供应商协议，供应组件的成本分析），以及可能用于影响业务的任何数据组织通过其供应商的运营被视为商业资产。

伙伴数据
“云”服务帐户信息
人力资产
在识别组织中的人力资产时，我们必须记住，上下文使这些资产成为破坏组织的更大努力的一部分。因此，被识别为商业资产的人力资产是那些可以用来泄露信息，被操纵以做出可能对组织产生负面影响的决策或行动或使攻击者能够进一步妥协的资产。人力资产不一定是公司层级中的最高层，但通常是与先前识别的业务资产相关的关键人员，或者是能够访问此类资产的关键人员。此列表还可以包括通常与访问受限制公司资产无关的员工，但可能有权向公司提供物理访问权限，从而有助于破坏安全或程序。以下列表提供了此类资产的一些示例，并应适应正在测试的组织。

执行管理
行政助理
中层管理人员
行政助理
技术/团队领导
工程师
技术员
人力资源
业务流程分析
如果企业不赚钱，就不是企业。这种情况的发生方式是让原始商品或知识通过各种流程来增强它们并创造附加价值。这会产生收入。业务流程和支持它们的资产（人员，技术，资金）形成价值链。通过映射这些流程，识别关键流程与非关键流程并最终发现其中的缺陷，我们能够了解业务如何运作，是什么让他们赚钱，以及最终威胁社区如何让他们亏钱。

在业务流程分析中，我们区分关键业务流程和非关键流程。对于每个类别，分析是相同的，并考虑相同的元素。主要区别在于权重，即分配关键业务流程的威胁而非非关键业务流程。然而，必须记住，一些非关键业务流程的聚合可以组合成一个基本上在元素/流程中形成关键缺陷的场景。此类威胁情景也应在此阶段确定，并映射出以供以后在渗透测试中使用。

技术基础设施支持流程
由于业务流程通常由IT基础架构（例如计算机网络，处理能力，用于输入信息和管理业务流程的PC等）支持，因此必须识别和映射所有这些元素。此类映射应足够清晰，以便在将威胁模型转换为漏洞映射和利用时在后续过程中使用。

信息资产支持流程
与技术基础设施相反，信息资产是组织中现有的知识库，既可以作为参考，也可以作为支持材料（决策，法律，营销等......）。此类资产通常已在业务流程中标识，并应与技术基础架构以及支持信息资产本身的任何其他技术基础架构一起映射。

人力资产支持流程
业务流程中涉及的人力资源的识别应与流程分析本身（无论是否记录在案）以及每个有任何参与的人（即使它与特定信息资产或应记录技术基础设施元素并在流程中进行映射。此类人力资源资产通常是审批子流程，验证子流程或甚至参考（如法律建议）的一部分。这些类型的资产（特别是与信息资产或技术基础设施无关的资产）将在以后映射到更具社交性而非技术性的攻击向量。

第三方集成和/或流程的使用
与支持该流程的人力资产类似，任何参与业务流程的第三方也应该进行映射。这个类别可能很难确定，因为它可能既包含人力资产，也包含信息/技术资产（如SaaS提供商）。

威胁代理/社区分析
在定义相关威胁社区和代理时，应在位置（组织内部/外部），位置内的特定社区以及有助于建立能力的任何其他相关信息方面明确识别威胁。 /特定代理人/社区的动机简介。在可能的情况下，应确定具体的代理人。否则，应该概述一个更普遍的社区，以及任何支持材料和情报。威胁代理/社区分类的一些示例是：

内部	外部
雇员	商业合作伙伴
管理（执行，中间）	竞争对手
管理员（网络，系统，服务器）	承包商
开发商	供应商
工程师	民族国家
技术员	有组织犯罪
承包商（与其外部用户）	黑客行动主义者
一般用户社区	脚本小子（娱乐/随机黑客）
远程支持	
雇员
根据兼职或全职合同直接为公司工作的人员。一般来说，他们不被视为构成严重威胁，因为他们大多数都依赖公司谋生，并且假设他们得到良好的待遇，他们倾向于保护公司而不是伤害公司。通常涉及数据丢失事件或意外泄露。在极少数情况下，他们可能会被外人激励以协助入侵，或者他们可能会自己进行恶意行为（例如流氓交易员）。虽然技能水平可能不同，但通常是低到中等。

管理（行政，中间）
如上所述，员工直接为公司工作。鉴于他们在公司内部的地位和职能，他们通常可以获得特权信息

威胁能力分析
一旦确定了威胁社区，还必须分析所述社区的能力，以便建立准确的威胁模型，该模型反映了这样的社区/代理成功地对组织采取行动并对其进行破坏的实际可能性。该分析既需要技术分析，也需要机会分析（如果适用）。

正在使用的工具分析
威胁社区/代理可以使用的任何工具都包含在此处。此外，应分析可免费提供的工具，以获得能够将其利用到潜力所需的技能水平，并映射到威胁能力中。

对相关漏洞/有效负载的可用性
应根据威胁社区/代理获取或开发与组织相关的环境的攻击的能力来分析威胁社区/代理。此外，在此分析中还应考虑通过第三方，业务合作伙伴或地下社区访问此类漏洞/有效负载。

沟通机制
应该对威胁代理/社区可用的通信机制进行分析，以评估针对组织的攻击的复杂性。这些通信机制包括简单和公开可用的技术，如加密，专家工具和服务，如防弹托管，丢弃站点的使用，以及使用已知或未知的僵尸网络来执行攻击或屏蔽源信息。例如，作为测试的一部分，我们测试以查看组织的整体攻击面是来自外部的。然而，还有另一个整体组件经常被错过。剥削后可能存在哪些类型的威胁？这属于检测渗出通道的背景。巧合的是，渗透测试人员的独特之处在于测试组织检测当今现代恶意软件的命令和控制通道的能力。当这是在范围内时，我们建议测试人员创建一系列恶意软件标本，以增加用于隐藏C2的混淆级别。目标是创建易于检测的恶意软件，然后将混淆增加到不再发生检测的程度。

无障碍
威胁行为者能力分析的最后一个要素是它们对组织和/或相关特定资产的可访问性。完成上述描述，同时考虑可访问性分析，这将使渗透测试能够创建与组织风险相关的明确方案。

动机建模
应注意威胁代理/社区的可能动机以供进一步分析。攻击者的动机不断变化，可以从Anonymous和Antisec等群体发起的黑客主义品牌攻击的增加中看出。基于每个组织和/或垂直市场的独特动机会有细微差别，一些常见动机包括：

利润（直接或间接）
黑客行为
直接怨恨
乐趣/声誉
进一步访问合作伙伴/连接系统
查找可比组织受损的相关新闻
为了提供完整的威胁模型，应该提供与同一行业垂直行业内其他组织的比较。此比较应包括与此类组织相关的任何相关事件或新闻及其面临的挑战。这种比较用于验证威胁模型并为组织提供基线以进行自我比较（考虑到此公开可用信息仅代表比较组织实际面临的实际威胁和事件的一部分）。
